.content
  .header
    %h1.page-title Containers
    %ul.breadcrumb
      %li
        = link_to "Home", index_path
      %li
        = link_to "Containers", containers_path
      %li.active= @container.name
  .main-content
    %ul.nav.nav-tabs
      %li.active
        %a{data: {toggle: "tab"}, href: "#view"} View
      %li
        %a{data: {toggle: "tab"}, href: "#edit"} Edit
      %li
        = link_to container_manage_items_path(@container) do
          Add Items
      %li
        = link_to new_pallet_path(container_id: @container.id) do
          New Pallet
    .row
      .col-md-5
        %br
        #myTabContent.tab-content
          #view.tab-pane.active.in
            = render partial: "form", locals: { no_edit: true, delete: true }

          #edit.tab-pane.fade
            = render partial: "form", locals: { no_edit: false, delete: false }

      .col-md-7
        %br
        %br
        - present(@container) do |container|
          .panel.panel-default
            %a.panel-heading{data: {toggle: "collapse"}, href: "#location"}
              Location Details
            #location.collapse.in
              %table.table.list
                %tbody
                  %tr
                    %td
                      %p Shipment
                    = container.shipment_location

        .panel.panel-default
          %a.panel-heading{data: {toggle: "collapse"}, href: "#pallets"}
            Pallets in this Container (#{@container.pallets.size})
          - if @container.pallets.any?
            #pallets.collapse.in
              %table.table.table-bordered.table-striped
                %thead
                  %tr
                    %th Custom ID
                    %th Name
                    %th Status
                %tbody
                  - @container.pallets.each do |pallet|
                    %tr
                      %td= pallet.custom_uid
                      %td
                        = link_to pallet_path(pallet) do
                          = pallet.name
                      %td= pallet.status
          - else
            #pallets.collapse.in.panel-body
              %h4 No pallets.
              = link_button("Create a Pallet", new_pallet_path(container_id: @container.id), "pull-left")

        .panel.panel-default
          %a.panel-heading.collapsed{data: {toggle: "collapse"}, href: "#containerizeditems"}
            Loose Items on this Container (#{@container.containerized_items.size})
          - if @container.containerized_items.any?
            #containerizeditems.collapse.in
              %table.table.table-bordered.table-striped
                %thead
                  %tr
                    %th Name
                    %th Expiry Date
                    %th Quantity
                %tbody
                  - @container.containerized_items.each do |ci|
                    %tr
                      %td
                        = link_to item_path(ci.item) do
                          = ci.generated_name
                      %td= ci.expiry_date&.strftime("%Y-%m-%d")
                      %td= ci.quantity
          - else
            #containerizeditems.collapse.in.panel-body
              %h5 Add loose items to this container from the tab.
