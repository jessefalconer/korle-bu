- item ||= @item
- submit_path ||= "item"
= form_for item do |f|
  .panel.panel-default
    %a.panel-heading{data: {toggle: "collapse"}, href: "#general-#{item.id}"}
      %i.fa.fa-clinic-medical
      General
      %i.fa.fa-edit.pull-right
    .collapse.in{id: "general-#{item.id}"}
      .row.form-row
        .col-xs-12
          .form-group
            = f.label :generated_name, "Base Name*"
            = f.text_field :generated_name, class: "form-control", placeholder: "Eg: syringe, acetaminophen, heart monitor"

  .panel.panel-default
    %a.panel-heading{data: {toggle: "collapse"}, href: "#photos-#{item.id}"}
      %i.fa.fa-images
      Photos & Notes
      %i.fa.fa-edit.pull-right
    .collapse{class: ((item.notes.present? || item.photo.attached?) && "in" ), id: "photos-#{item.id}"}
      .row.form-row
        .col-xs-12
          .form-group
            = f.label :notes
            = f.text_field :notes, class: "form-control"
        .col-xs-8
          .form-group
            = f.label :photo
            = f.file_field :photo, class: "form-control", accept: "image/png, image/gif, image/jpeg"
        .col-xs-4
          .form-group.inline-image-checkbox
            = check_box_tag :destroy_photo, disabled: "disabled", class: "form-control"
            %label Delete Photo

  .row.select-fields
    .col-xs-12
      .form-group
        = f.label :category
        = f.select(:category_id, options_from_collection_for_select(Category.order(:name), :id, :name, item.category_id), { include_blank: "" }, { class: "form-control" })

  .row.select-fields
    .col-xs-6
      .form-group
        = f.label :flagged, "Flag for Review"
        = f.select(:flagged, options_for_select([true, false], item.flagged), {}, { class: "form-control" })
    - if can? :reconcile, Item
      .col-xs-6
        .form-group
          = f.label :verified
          = f.select(:verified, options_for_select([true, false], item.verified), {}, { class: "form-control" })

  - if submit_path == "item"
    .row
      .col-xs-12
        .btn-toolbar.list-toolbar
          - if item.persisted?
            = delete_button(item_path(item), "Are you sure you want to delete #{item.generated_name}? This will also delete any items in boxes, pallets, containers and cannot be reversed.")
          = submit_button_responsive("Save")
  - elsif submit_path == "reconcile" && redirect
    .row.padding-top
      .col-xs-12
        .btn-toolbar.list-toolbar.text-center
          - if item.persisted?
            = delete_button(item_path(item, redirect: redirect), "Are you sure you want to delete #{item.generated_name}? This will also delete any items in boxes, pallets, containers and cannot be reversed.")
          = submit_button_redirect("Save and Exit", redirect)
          %button.btn.btn-warning{data: {dismiss: "modal"}, type: "button"}
            %i.fa.fa-times
            Cancel
        .btn-toolbar.list-toolbar.text-center
          = submit_button_redirect("Save and Reconcile", "reconcile_start_path", "fa-compress-alt")
          = link_to reconcile_start_path(item), class: "btn btn-info" do
            %i.fa.fa-compress-alt
            Start Reconcile
